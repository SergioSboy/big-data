## Цель приложения

* Имитация **реального потока данных отзывов**.
* Используется **Kafka** для передачи данных между **Producer → Consumer → ML модель → Dashboard**.
* Применяется **машинное обучение** для анализа тональности отзывов.
* Данные визуализируются на **дашборде** (Streamlit или Dash).

---

## Поток данных

1. **Подготовка данных**

   * CSV с отзывами (`reviews.csv`) собирается или генерируется скриптом `prepare_data_model.ipynb`.
   * Формат: `review_id`, `user_id`, `product_category`, `text`, `rating`, `timestamp`.

2. **Producer** (`producer.py`)

   * Читает CSV и отправляет сообщения в топик Kafka `raw_reviews`.
   * Использует случайные задержки (`time.sleep`) для имитации реального времени.

3. **Kafka**

   * Действует как брокер сообщений.
   * Обеспечивает **буферизацию и доставку** данных между Producer и Consumer.

4. **Consumer** (`consumer.py`)

   * Подписан на топик `raw_reviews`.
   * Получает сообщения, передаёт текст в ML модель (`SentimentModel`) для предсказания тональности.
   * Добавляет к данным поля: `sentiment` и `confidence`.
   * Отправляет обработанные сообщения в топик `processed_reviews`.
   * Также хранит **скользящее окно** последних N отзывов для статистики.

5. **ML модель** (`model.py`)

   * Например, Logistic Regression + TF-IDF vectorizer.
   * Предсказывает тональность: `positive` / `negative` и вероятность уверенности.

6. **Dashboard** (`dashboard/app.py`)

   * Подписан на топик `processed_reviews` или читает статистику из JSON файла.
   * Визуализирует поток данных:

     * Общее количество положительных / отрицательных отзывов
     * Процент положительных отзывов
     * Графики рейтингов и категорий продуктов

---

## Как запустить (Docker)

1. Собрать и поднять Kafka и сервисы:

```bash
docker-compose up --build
```

2. Подготовить CSV:

```bash
python backend/prepare_dataset.py
```

3. Запустить Producer:

```bash
docker-compose run producer
```

4. Запустить Consumer:

```bash
docker-compose run consumer
```

5. Dashboard:

* Перейти в браузере на `http://localhost:8501` (если Streamlit)
* Визуализируются потоковые данные и статистика тональности

---

## Что можно наблюдать

* Отзывы поступают **почти в реальном времени**
* Статистика скользящего окна обновляется каждые N сообщений
* Можно видеть **динамику положительных и отрицательных отзывов** по продуктам
* ML модель демонстрирует **анализ тональности** на лету

